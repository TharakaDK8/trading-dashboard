<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trading Dashboard - Forex & Crypto</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        header {
            background: rgba(255, 255, 255, 0.95);
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        h1 {
            color: #667eea;
            font-size: 2em;
            margin-bottom: 10px;
        }

        .status-indicator {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 6px 12px;
            background: #e8f5e9;
            border-radius: 20px;
            font-size: 13px;
            margin-top: 10px;
        }

        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #4caf50;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .nav-tabs {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-top: 15px;
        }

        .tab-btn {
            padding: 10px 20px;
            border: none;
            background: #667eea;
            color: white;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
        }

        .tab-btn:hover {
            background: #764ba2;
            transform: translateY(-2px);
        }

        .tab-btn.active {
            background: #764ba2;
            box-shadow: 0 4px 15px rgba(118, 75, 162, 0.4);
        }

        .content-section {
            display: none;
        }

        .content-section.active {
            display: block;
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .card {
            background: rgba(255, 255, 255, 0.95);
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .card h2 {
            color: #667eea;
            margin-bottom: 15px;
            font-size: 1.4em;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .input-group {
            margin-bottom: 15px;
        }

        label {
            display: block;
            margin-bottom: 5px;
            color: #555;
            font-weight: 500;
        }

        input, select {
            width: 100%;
            padding: 10px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 14px;
            transition: border 0.3s;
        }

        input:focus, select:focus {
            outline: none;
            border-color: #667eea;
        }

        button {
            width: 100%;
            padding: 12px;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        button:hover {
            background: #764ba2;
            transform: translateY(-2px);
        }

        .result {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px;
            border-radius: 8px;
            margin-top: 15px;
            font-size: 18px;
            font-weight: 600;
            text-align: center;
        }

        .result-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-top: 15px;
        }

        .result-item {
            background: #f5f5f5;
            padding: 10px;
            border-radius: 8px;
            text-align: center;
        }

        .result-item label {
            font-size: 12px;
            color: #666;
        }

        .result-item value {
            display: block;
            font-size: 16px;
            font-weight: 600;
            color: #667eea;
            margin-top: 5px;
        }

        .price-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            position: relative;
        }

        .price-card.loading {
            opacity: 0.7;
        }

        .price-card h3 {
            font-size: 1.2em;
            margin-bottom: 10px;
        }

        .price {
            font-size: 2em;
            font-weight: 700;
            margin: 10px 0;
        }

        .change {
            font-size: 1.1em;
            padding: 5px 10px;
            border-radius: 5px;
            display: inline-block;
        }

        .change.positive {
            background: rgba(0, 255, 0, 0.2);
        }

        .change.negative {
            background: rgba(255, 0, 0, 0.2);
        }

        .last-update {
            font-size: 0.75em;
            opacity: 0.8;
            margin-top: 8px;
        }

        .news-item {
            background: #f9f9f9;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 10px;
            border-left: 4px solid #667eea;
        }

        .news-item h4 {
            color: #333;
            margin-bottom: 8px;
        }

        .news-item p {
            color: #666;
            font-size: 14px;
            line-height: 1.6;
        }

        .news-time {
            color: #999;
            font-size: 12px;
            margin-top: 5px;
        }

        .trade-idea {
            background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
            color: white;
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 15px;
        }

        .trade-idea h3 {
            margin-bottom: 10px;
        }

        .trade-details {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-top: 10px;
        }

        .trade-detail-item {
            background: rgba(255, 255, 255, 0.2);
            padding: 8px;
            border-radius: 5px;
        }

        .loading {
            text-align: center;
            padding: 20px;
            color: #667eea;
        }

        .calendar-event {
            background: #f9f9f9;
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 10px;
            border-left: 4px solid #764ba2;
        }

        .event-time {
            font-weight: 600;
            color: #667eea;
            margin-bottom: 5px;
        }

        .event-impact {
            display: inline-block;
            padding: 3px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 600;
            margin-left: 10px;
        }

        .impact-high {
            background: #ff4444;
            color: white;
        }

        .impact-medium {
            background: #ffa500;
            color: white;
        }

        .impact-low {
            background: #4CAF50;
            color: white;
        }

        .compounding-table {
            width: 100%;
            margin-top: 15px;
            border-collapse: collapse;
        }

        .compounding-table th,
        .compounding-table td {
            padding: 10px;
            text-align: left;
            border-bottom: 1px solid #e0e0e0;
        }

        .compounding-table th {
            background: #667eea;
            color: white;
            font-weight: 600;
        }

        .compounding-table tr:hover {
            background: #f5f5f5;
        }

        .error-message {
            background: #ffebee;
            color: #c62828;
            padding: 12px;
            border-radius: 8px;
            margin-top: 10px;
            font-size: 14px;
        }

        .refresh-btn {
            background: rgba(255, 255, 255, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: white;
            padding: 8px 16px;
            border-radius: 6px;
            font-size: 12px;
            cursor: pointer;
            margin-top: 10px;
            transition: all 0.3s;
        }

        .refresh-btn:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        @media (max-width: 768px) {
            .grid {
                grid-template-columns: 1fr;
            }
            
            h1 {
                font-size: 1.5em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üìà Trading Dashboard</h1>
            <p>Forex & Crypto Market Analysis Tools</p>
            <div class="status-indicator">
                <div class="status-dot"></div>
                <span>Live Data Connected</span>
            </div>
            <div class="nav-tabs">
                <button class="tab-btn active" onclick="switchTab('market')">üìä Market Analysis</button>
                <button class="tab-btn" onclick="switchTab('calculators')">üßÆ Calculators</button>
                <button class="tab-btn" onclick="switchTab('news')">üì∞ News & Events</button>
                <button class="tab-btn" onclick="switchTab('ideas')">üí° Trade Ideas</button>
            </div>
        </header>

        <!-- Market Analysis Section -->
        <div id="market" class="content-section active">
            <div class="grid">
                <div class="price-card" id="eurusd-card">
                    <h3>EUR/USD</h3>
                    <div class="price" id="eurusd-price">Loading...</div>
                    <div class="change" id="eurusd-change">-</div>
                    <div class="last-update" id="eurusd-update">Connecting...</div>
                    <button class="refresh-btn" onclick="refreshForexPrices()">üîÑ Refresh</button>
                </div>
                <div class="price-card" id="gbpusd-card">
                    <h3>GBP/USD</h3>
                    <div class="price" id="gbpusd-price">Loading...</div>
                    <div class="change" id="gbpusd-change">-</div>
                    <div class="last-update" id="gbpusd-update">Connecting...</div>
                </div>
                <div class="price-card" id="btc-card">
                    <h3>BTC/USD</h3>
                    <div class="price" id="btc-price">Loading...</div>
                    <div class="change" id="btc-change">-</div>
                    <div class="last-update" id="btc-update">Connecting...</div>
                    <button class="refresh-btn" onclick="refreshCryptoPrices()">üîÑ Refresh</button>
                </div>
                <div class="price-card" id="eth-card">
                    <h3>ETH/USD</h3>
                    <div class="price" id="eth-price">Loading...</div>
                    <div class="change" id="eth-change">-</div>
                    <div class="last-update" id="eth-update">Connecting...</div>
                </div>
            </div>

            <div class="card">
                <h2>üìâ Additional Markets</h2>
                <div class="result-grid">
                    <div class="result-item">
                        <label>USD/JPY</label>
                        <value id="usdjpy">Loading...</value>
                    </div>
                    <div class="result-item">
                        <label>AUD/USD</label>
                        <value id="audusd">Loading...</value>
                    </div>
                    <div class="result-item">
                        <label>BNB/USD</label>
                        <value id="bnb">Loading...</value>
                    </div>
                    <div class="result-item">
                        <label>SOL/USD</label>
                        <value id="sol">Loading...</value>
                    </div>
                </div>
                <div id="market-error" style="display: none;" class="error-message"></div>
            </div>
        </div>

        <!-- Calculators Section -->
        <div id="calculators" class="content-section">
            <div class="grid">
                <!-- Profit Calculator -->
                <div class="card">
                    <h2>üí∞ Profit Calculator</h2>
                    <div class="input-group">
                        <label>Entry Price</label>
                        <input type="number" id="entry-price" placeholder="1.0800" step="0.0001">
                    </div>
                    <div class="input-group">
                        <label>Exit Price</label>
                        <input type="number" id="exit-price" placeholder="1.0850" step="0.0001">
                    </div>
                    <div class="input-group">
                        <label>Position Size (Lots)</label>
                        <input type="number" id="profit-lots" placeholder="1.0" step="0.01">
                    </div>
                    <div class="input-group">
                        <label>Trade Type</label>
                        <select id="trade-type">
                            <option value="buy">Buy (Long)</option>
                            <option value="sell">Sell (Short)</option>
                        </select>
                    </div>
                    <button onclick="calculateProfit()">Calculate Profit</button>
                    <div class="result" id="profit-result" style="display: none;"></div>
                </div>

                <!-- Lot Size Calculator -->
                <div class="card">
                    <h2>üìè Lot Size Calculator</h2>
                    <div class="input-group">
                        <label>Account Balance</label>
                        <input type="number" id="account-balance" placeholder="10000" step="100">
                    </div>
                    <div class="input-group">
                        <label>Risk Percentage (%)</label>
                        <input type="number" id="risk-percent" placeholder="2" step="0.1" max="100">
                    </div>
                    <div class="input-group">
                        <label>Stop Loss (Pips)</label>
                        <input type="number" id="stop-loss-pips" placeholder="50" step="1">
                    </div>
                    <div class="input-group">
                        <label>Currency Pair</label>
                        <select id="currency-pair">
                            <option value="eurusd">EUR/USD</option>
                            <option value="gbpusd">GBP/USD</option>
                            <option value="usdjpy">USD/JPY</option>
                            <option value="audusd">AUD/USD</option>
                        </select>
                    </div>
                    <button onclick="calculateLotSize()">Calculate Lot Size</button>
                    <div class="result" id="lotsize-result" style="display: none;"></div>
                </div>

                <!-- Compounding Calculator -->
                <div class="card">
                    <h2>üìà Compounding Calculator</h2>
                    <div class="input-group">
                        <label>Starting Balance</label>
                        <input type="number" id="starting-balance" placeholder="5000" step="100">
                    </div>
                    <div class="input-group">
                        <label>Monthly Return (%)</label>
                        <input type="number" id="monthly-return" placeholder="5" step="0.1">
                    </div>
                    <div class="input-group">
                        <label>Number of Months</label>
                        <input type="number" id="months" placeholder="12" step="1" max="120">
                    </div>
                    <div class="input-group">
                        <label>Monthly Withdrawal</label>
                        <input type="number" id="monthly-withdrawal" placeholder="0" step="100">
                    </div>
                    <button onclick="calculateCompounding()">Calculate Growth</button>
                    <div id="compounding-results" style="display: none;">
                        <div class="result"></div>
                        <table class="compounding-table">
                            <thead>
                                <tr>
                                    <th>Month</th>
                                    <th>Balance</th>
                                    <th>Profit</th>
                                </tr>
                            </thead>
                            <tbody id="compounding-table-body"></tbody>
                        </table>
                    </div>
                </div>

                <!-- Risk/Reward Calculator -->
                <div class="card">
                    <h2>‚öñÔ∏è Risk/Reward Calculator</h2>
                    <div class="input-group">
                        <label>Entry Price</label>
                        <input type="number" id="rr-entry" placeholder="1.0800" step="0.0001">
                    </div>
                    <div class="input-group">
                        <label>Stop Loss Price</label>
                        <input type="number" id="rr-sl" placeholder="1.0750" step="0.0001">
                    </div>
                    <div class="input-group">
                        <label>Take Profit Price</label>
                        <input type="number" id="rr-tp" placeholder="1.0900" step="0.0001">
                    </div>
                    <button onclick="calculateRiskReward()">Calculate R:R Ratio</button>
                    <div class="result-grid" id="rr-results" style="display: none; margin-top: 15px;">
                        <div class="result-item">
                            <label>Risk (Pips)</label>
                            <value id="risk-pips"></value>
                        </div>
                        <div class="result-item">
                            <label>Reward (Pips)</label>
                            <value id="reward-pips"></value>
                        </div>
                        <div class="result-item">
                            <label>R:R Ratio</label>
                            <value id="rr-ratio"></value>
                        </div>
                        <div class="result-item">
                            <label>Win Rate Needed</label>
                            <value id="win-rate"></value>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- News & Events Section -->
        <div id="news" class="content-section">
            <div class="grid">
                <div class="card">
                    <h2>üì∞ Latest Market News</h2>
                    <div id="news-container">
                        <div class="news-item">
                            <h4>Federal Reserve Signals Cautious Approach</h4>
                            <p>The Fed maintains its stance on interest rates amid inflation concerns, signaling a data-dependent approach for upcoming meetings.</p>
                            <div class="news-time">2 hours ago</div>
                        </div>
                        <div class="news-item">
                            <h4>Bitcoin ETF Sees Record Inflows</h4>
                            <p>Institutional investors continue to pour money into Bitcoin ETFs, with this week marking the highest weekly inflows since launch.</p>
                            <div class="news-time">4 hours ago</div>
                        </div>
                        <div class="news-item">
                            <h4>EUR Strengthens on ECB Comments</h4>
                            <p>The Euro rallied against major currencies following hawkish comments from ECB officials regarding inflation targets.</p>
                            <div class="news-time">6 hours ago</div>
                        </div>
                        <div class="news-item">
                            <h4>Oil Prices Surge on Supply Concerns</h4>
                            <p>Crude oil prices jumped 3% as production cuts from major exporters tighten global supply.</p>
                            <div class="news-time">8 hours ago</div>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <h2>üìÖ Economic Calendar</h2>
                    <div id="calendar-container">
                        <div class="calendar-event">
                            <div class="event-time">Today, 13:30 UTC</div>
                            <strong>üá∫üá∏ US Non-Farm Payrolls</strong>
                            <span class="event-impact impact-high">HIGH</span>
                            <p style="margin-top: 8px; color: #666;">Expected: 175K | Previous: 216K</p>
                        </div>
                        <div class="calendar-event">
                            <div class="event-time">Today, 15:00 UTC</div>
                            <strong>üá∫üá∏ FOMC Meeting Minutes</strong>
                            <span class="event-impact impact-high">HIGH</span>
                        </div>
                        <div class="calendar-event">
                            <div class="event-time">Tomorrow, 09:00 UTC</div>
                            <strong>üá™üá∫ ECB Interest Rate Decision</strong>
                            <span class="event-impact impact-high">HIGH</span>
                            <p style="margin-top: 8px; color: #666;">Expected: 4.50% | Previous: 4.50%</p>
                        </div>
                        <div class="calendar-event">
                            <div class="event-time">Tomorrow, 12:30 UTC</div>
                            <strong>üá¨üáß UK GDP Growth</strong>
                            <span class="event-impact impact-medium">MEDIUM</span>
                            <p style="margin-top: 8px; color: #666;">Expected: 0.2% | Previous: 0.1%</p>
                        </div>
                        <div class="calendar-event">
                            <div class="event-time">Feb 18, 01:00 UTC</div>
                            <strong>üáØüáµ Japan CPI</strong>
                            <span class="event-impact impact-medium">MEDIUM</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Trade Ideas Section -->
        <div id="ideas" class="content-section">
            <div class="card">
                <h2>üí° Today's Trade Ideas</h2>
                
                <div class="trade-idea">
                    <h3>üîµ EUR/USD - Long Setup</h3>
                    <p><strong>Strategy:</strong> Breakout above resistance</p>
                    <div class="trade-details">
                        <div class="trade-detail-item">
                            <strong>Entry:</strong> 1.0860
                        </div>
                        <div class="trade-detail-item">
                            <strong>Stop Loss:</strong> 1.0820
                        </div>
                        <div class="trade-detail-item">
                            <strong>Take Profit 1:</strong> 1.0900
                        </div>
                        <div class="trade-detail-item">
                            <strong>Take Profit 2:</strong> 1.0940
                        </div>
                    </div>
                    <p style="margin-top: 10px;"><strong>Analysis:</strong> Price showing bullish momentum with higher lows. Key resistance break could lead to 100+ pip move.</p>
                </div>

                <div class="trade-idea" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">
                    <h3>üî¥ GBP/JPY - Short Setup</h3>
                    <p><strong>Strategy:</strong> Rejection from resistance zone</p>
                    <div class="trade-details">
                        <div class="trade-detail-item">
                            <strong>Entry:</strong> 189.50
                        </div>
                        <div class="trade-detail-item">
                            <strong>Stop Loss:</strong> 190.20
                        </div>
                        <div class="trade-detail-item">
                            <strong>Take Profit 1:</strong> 188.50
                        </div>
                        <div class="trade-detail-item">
                            <strong>Take Profit 2:</strong> 187.80
                        </div>
                    </div>
                    <p style="margin-top: 10px;"><strong>Analysis:</strong> Strong resistance at 190.00 level. RSI showing divergence suggesting potential reversal.</p>
                </div>

                <div class="trade-idea" style="background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);">
                    <h3>üü° BTC/USD - Swing Trade</h3>
                    <p><strong>Strategy:</strong> Support bounce play</p>
                    <div class="trade-details">
                        <div class="trade-detail-item">
                            <strong>Entry:</strong> $62,500
                        </div>
                        <div class="trade-detail-item">
                            <strong>Stop Loss:</strong> $60,800
                        </div>
                        <div class="trade-detail-item">
                            <strong>Take Profit 1:</strong> $65,000
                        </div>
                        <div class="trade-detail-item">
                            <strong>Take Profit 2:</strong> $67,500
                        </div>
                    </div>
                    <p style="margin-top: 10px;"><strong>Analysis:</strong> Bitcoin finding support at key Fibonacci level. Institutional buying pressure increasing.</p>
                </div>

                <div class="trade-idea" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);">
                    <h3>üîµ XAU/USD (Gold) - Long Setup</h3>
                    <p><strong>Strategy:</strong> Safe haven demand</p>
                    <div class="trade-details">
                        <div class="trade-detail-item">
                            <strong>Entry:</strong> $2,040
                        </div>
                        <div class="trade-detail-item">
                            <strong>Stop Loss:</strong> $2,025
                        </div>
                        <div class="trade-detail-item">
                            <strong>Take Profit 1:</strong> $2,065
                        </div>
                        <div class="trade-detail-item">
                            <strong>Take Profit 2:</strong> $2,085
                        </div>
                    </div>
                    <p style="margin-top: 10px;"><strong>Analysis:</strong> Gold rallying on geopolitical tensions and dovish Fed expectations. Technical breakout confirmed.</p>
                </div>

                <div style="background: rgba(255,255,255,0.95); padding: 20px; border-radius: 15px; margin-top: 20px;">
                    <h3 style="color: #667eea; margin-bottom: 10px;">‚ö†Ô∏è Risk Disclaimer</h3>
                    <p style="color: #666; line-height: 1.6;">These trade ideas are for educational purposes only and should not be considered financial advice. Trading forex and cryptocurrencies involves substantial risk of loss. Always use proper risk management and never risk more than you can afford to lose. Past performance does not guarantee future results.</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Store previous prices for comparison
        let previousPrices = {};

        // Tab Switching
        function switchTab(tabName) {
            document.querySelectorAll('.content-section').forEach(section => {
                section.classList.remove('active');
            });
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
        }

        // Fetch Crypto Prices from CoinGecko (Free API, no key required)
        async function fetchCryptoPrices() {
            try {
                const response = await fetch('https://api.coingecko.com/api/v3/simple/price?ids=bitcoin,ethereum,binancecoin,solana&vs_currencies=usd&include_24hr_change=true');
                const data = await response.json();
                
                // Bitcoin
                updatePriceCard('btc', data.bitcoin.usd, data.bitcoin.usd_24h_change);
                
                // Ethereum
                updatePriceCard('eth', data.ethereum.usd, data.ethereum.usd_24h_change);
                
                // Binance Coin
                document.getElementById('bnb').textContent = `$${data.binancecoin.usd.toLocaleString()}`;
                
                // Solana
                document.getElementById('sol').textContent = `$${data.solana.usd.toFixed(2)}`;
                
                document.getElementById('market-error').style.display = 'none';
            } catch (error) {
                console.error('Error fetching crypto prices:', error);
                showError('Unable to fetch cryptocurrency prices. Please try again later.');
            }
        }

        // Fetch Forex Prices from Frankfurter (Free API, no key required)
        async function fetchForexPrices() {
            try {
                // Fetch EUR/USD, GBP/USD
                const response = await fetch('https://api.frankfurter.app/latest?from=USD&to=EUR,GBP,JPY,AUD');
                const data = await response.json();
                
                // Calculate forex rates
                const eurusd = 1 / data.rates.EUR;
                const gbpusd = 1 / data.rates.GBP;
                const usdjpy = data.rates.JPY;
                const audusd = 1 / data.rates.AUD;
                
                // Update EUR/USD
                updateForexCard('eurusd', eurusd);
                
                // Update GBP/USD
                updateForexCard('gbpusd', gbpusd);
                
                // Update USD/JPY
                document.getElementById('usdjpy').textContent = usdjpy.toFixed(2);
                
                // Update AUD/USD
                document.getElementById('audusd').textContent = audusd.toFixed(4);
                
                document.getElementById('market-error').style.display = 'none';
            } catch (error) {
                console.error('Error fetching forex prices:', error);
                showError('Unable to fetch forex prices. Please try again later.');
            }
        }

        // Update price card with animation
        function updatePriceCard(id, price, change) {
            const priceElement = document.getElementById(`${id}-price`);
            const changeElement = document.getElementById(`${id}-change`);
            const updateElement = document.getElementById(`${id}-update`);
            
            // Format price
            let formattedPrice;
            if (id === 'btc' || id === 'eth') {
                formattedPrice = `$${price.toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2})}`;
            } else {
                formattedPrice = price.toFixed(4);
            }
            
            priceElement.textContent = formattedPrice;
            
            // Update change
            if (change !== undefined) {
                const changeText = `${change >= 0 ? '+' : ''}${change.toFixed(2)}%`;
                changeElement.textContent = changeText;
                changeElement.className = change >= 0 ? 'change positive' : 'change negative';
            }
            
            // Update timestamp
            const now = new Date();
            updateElement.textContent = `Updated: ${now.toLocaleTimeString()}`;
        }

        // Update forex card
        function updateForexCard(id, price) {
            const priceElement = document.getElementById(`${id}-price`);
            const changeElement = document.getElementById(`${id}-change`);
            const updateElement = document.getElementById(`${id}-update`);
            
            // Calculate change if we have previous price
            let change = 0;
            if (previousPrices[id]) {
                change = ((price - previousPrices[id]) / previousPrices[id]) * 100;
            }
            previousPrices[id] = price;
            
            priceElement.textContent = price.toFixed(4);
            
            if (change !== 0) {
                const changeText = `${change >= 0 ? '+' : ''}${change.toFixed(2)}%`;
                changeElement.textContent = changeText;
                changeElement.className = change >= 0 ? 'change positive' : 'change negative';
            }
            
            // Update timestamp
            const now = new Date();
            updateElement.textContent = `Updated: ${now.toLocaleTimeString()}`;
        }

        // Show error message
        function showError(message) {
            const errorDiv = document.getElementById('market-error');
            errorDiv.textContent = message;
            errorDiv.style.display = 'block';
        }

        // Refresh functions
        function refreshCryptoPrices() {
            fetchCryptoPrices();
        }

        function refreshForexPrices() {
            fetchForexPrices();
        }

        // Profit Calculator
        function calculateProfit() {
            const entry = parseFloat(document.getElementById('entry-price').value);
            const exit = parseFloat(document.getElementById('exit-price').value);
            const lots = parseFloat(document.getElementById('profit-lots').value);
            const tradeType = document.getElementById('trade-type').value;
            
            if (!entry || !exit || !lots) {
                alert('Please fill in all fields');
                return;
            }
            
            let pipValue = 10; // Standard for forex (assuming USD account)
            let pips = 0;
            
            if (tradeType === 'buy') {
                pips = (exit - entry) * 10000; // Convert to pips
            } else {
                pips = (entry - exit) * 10000;
            }
            
            const profit = pips * pipValue * lots;
            
            const resultDiv = document.getElementById('profit-result');
            resultDiv.style.display = 'block';
            resultDiv.innerHTML = `
                <div>Pips: ${pips.toFixed(1)}</div>
                <div>Profit/Loss: $${profit.toFixed(2)}</div>
            `;
            resultDiv.style.background = profit >= 0 
                ? 'linear-gradient(135deg, #11998e 0%, #38ef7d 100%)'
                : 'linear-gradient(135deg, #eb3349 0%, #f45c43 100%)';
        }

        // Lot Size Calculator
        function calculateLotSize() {
            const balance = parseFloat(document.getElementById('account-balance').value);
            const riskPercent = parseFloat(document.getElementById('risk-percent').value);
            const stopLossPips = parseFloat(document.getElementById('stop-loss-pips').value);
            
            if (!balance || !riskPercent || !stopLossPips) {
                alert('Please fill in all fields');
                return;
            }
            
            const riskAmount = balance * (riskPercent / 100);
            const pipValue = 10; // Standard pip value
            const lotSize = riskAmount / (stopLossPips * pipValue);
            
            const resultDiv = document.getElementById('lotsize-result');
            resultDiv.style.display = 'block';
            resultDiv.innerHTML = `
                <div>Recommended Lot Size</div>
                <div style="font-size: 2em; margin-top: 10px;">${lotSize.toFixed(2)} lots</div>
                <div style="font-size: 0.9em; margin-top: 10px;">Risk Amount: $${riskAmount.toFixed(2)}</div>
            `;
        }

        // Compounding Calculator
        function calculateCompounding() {
            const startingBalance = parseFloat(document.getElementById('starting-balance').value);
            const monthlyReturn = parseFloat(document.getElementById('monthly-return').value) / 100;
            const months = parseInt(document.getElementById('months').value);
            const withdrawal = parseFloat(document.getElementById('monthly-withdrawal').value) || 0;
            
            if (!startingBalance || !monthlyReturn || !months) {
                alert('Please fill in required fields');
                return;
            }
            
            let balance = startingBalance;
            let tableHtml = '';
            let totalProfit = 0;
            
            for (let i = 1; i <= months; i++) {
                const monthProfit = balance * monthlyReturn;
                totalProfit += monthProfit;
                balance = balance + monthProfit - withdrawal;
                
                if (i <= 24) { // Show first 24 months in table
                    tableHtml += `
                        <tr>
                            <td>Month ${i}</td>
                            <td>$${balance.toFixed(2)}</td>
                            <td style="color: #11998e; font-weight: 600;">+$${monthProfit.toFixed(2)}</td>
                        </tr>
                    `;
                }
            }
            
            const resultsDiv = document.getElementById('compounding-results');
            resultsDiv.style.display = 'block';
            
            const resultSummary = resultsDiv.querySelector('.result');
            resultSummary.innerHTML = `
                <div>Final Balance: $${balance.toFixed(2)}</div>
                <div style="font-size: 0.9em; margin-top: 10px;">
                    Total Profit: $${totalProfit.toFixed(2)} | 
                    ROI: ${((balance - startingBalance) / startingBalance * 100).toFixed(1)}%
                </div>
            `;
            
            document.getElementById('compounding-table-body').innerHTML = tableHtml;
        }

        // Risk/Reward Calculator
        function calculateRiskReward() {
            const entry = parseFloat(document.getElementById('rr-entry').value);
            const sl = parseFloat(document.getElementById('rr-sl').value);
            const tp = parseFloat(document.getElementById('rr-tp').value);
            
            if (!entry || !sl || !tp) {
                alert('Please fill in all fields');
                return;
            }
            
            const riskPips = Math.abs(entry - sl) * 10000;
            const rewardPips = Math.abs(tp - entry) * 10000;
            const rrRatio = rewardPips / riskPips;
            const winRateNeeded = (1 / (1 + rrRatio)) * 100;
            
            document.getElementById('rr-results').style.display = 'grid';
            document.getElementById('risk-pips').textContent = riskPips.toFixed(1);
            document.getElementById('reward-pips').textContent = rewardPips.toFixed(1);
            document.getElementById('rr-ratio').textContent = `1:${rrRatio.toFixed(2)}`;
            document.getElementById('win-rate').textContent = `${winRateNeeded.toFixed(1)}%`;
        }

        // Initialize - Fetch all prices on load
        window.addEventListener('load', function() {
            fetchCryptoPrices();
            fetchForexPrices();
            
            // Auto-refresh every 60 seconds
            setInterval(function() {
                fetchCryptoPrices();
                fetchForexPrices();
            }, 60000);
        });
    </script>
</body>
</html>
