<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ProTrade Dashboard - Live Markets</title>
    <script type="text/javascript" src="https://s3.tradingview.com/tv.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #0a0e27;
            color: #fff;
            overflow-x: hidden;
        }

        /* Sidebar Navigation */
        .sidebar {
            position: fixed;
            left: 0;
            top: 0;
            height: 100vh;
            width: 260px;
            background: linear-gradient(180deg, #1a1f3a 0%, #0f1729 100%);
            border-right: 1px solid rgba(102, 126, 234, 0.2);
            padding: 30px 0;
            z-index: 1000;
            transition: all 0.3s ease;
        }

        .sidebar-header {
            padding: 0 25px 30px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 24px;
            font-weight: 700;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .logo-icon {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
        }

        .status-badge {
            margin-top: 15px;
            padding: 8px 12px;
            background: rgba(76, 175, 80, 0.15);
            border-radius: 8px;
            font-size: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
            border: 1px solid rgba(76, 175, 80, 0.3);
        }

        .status-dot {
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background: #4caf50;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.7; transform: scale(1.1); }
        }

        .nav-menu {
            margin-top: 30px;
            padding: 0 15px;
        }

        .nav-item {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 14px 15px;
            margin-bottom: 8px;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            color: #a0a4b8;
            font-size: 15px;
            font-weight: 500;
            border: 1px solid transparent;
        }

        .nav-item:hover {
            background: rgba(102, 126, 234, 0.1);
            color: #fff;
            transform: translateX(5px);
        }

        .nav-item.active {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.2) 0%, rgba(118, 75, 162, 0.2) 100%);
            color: #fff;
            border: 1px solid rgba(102, 126, 234, 0.3);
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.2);
        }

        .nav-item i {
            font-size: 20px;
            width: 24px;
            text-align: center;
        }

        .nav-footer {
            position: absolute;
            bottom: 20px;
            left: 0;
            right: 0;
            padding: 0 25px;
        }

        .time-widget {
            background: rgba(255, 255, 255, 0.05);
            padding: 12px;
            border-radius: 10px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .time-widget .time {
            font-size: 20px;
            font-weight: 700;
            color: #667eea;
        }

        .time-widget .label {
            font-size: 11px;
            color: #888;
            margin-top: 4px;
        }

        /* Main Content */
        .main-content {
            margin-left: 260px;
            padding: 30px;
            min-height: 100vh;
        }

        .topbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            background: rgba(255, 255, 255, 0.03);
            padding: 20px 25px;
            border-radius: 15px;
            border: 1px solid rgba(255, 255, 255, 0.08);
            backdrop-filter: blur(10px);
        }

        .topbar-left h1 {
            font-size: 28px;
            margin-bottom: 5px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .topbar-left p {
            color: #888;
            font-size: 14px;
        }

        .topbar-right {
            display: flex;
            gap: 15px;
            align-items: center;
        }

        .refresh-badge {
            padding: 10px 18px;
            background: rgba(102, 126, 234, 0.15);
            border-radius: 10px;
            font-size: 13px;
            border: 1px solid rgba(102, 126, 234, 0.3);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .refresh-timer {
            font-weight: 700;
            color: #667eea;
        }

        .content-section {
            display: none;
            animation: fadeIn 0.4s ease;
        }

        .content-section.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .grid-2 {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }

        .card {
            background: rgba(255, 255, 255, 0.03);
            backdrop-filter: blur(10px);
            padding: 25px;
            border-radius: 15px;
            border: 1px solid rgba(255, 255, 255, 0.08);
            transition: all 0.3s ease;
        }

        .card:hover {
            border-color: rgba(102, 126, 234, 0.3);
            box-shadow: 0 8px 30px rgba(102, 126, 234, 0.15);
            transform: translateY(-2px);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .card h2 {
            color: #fff;
            font-size: 18px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .section-title {
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 20px;
            color: #fff;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .price-card {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.1) 0%, rgba(118, 75, 162, 0.1) 100%);
            padding: 20px;
            border-radius: 12px;
            border: 1px solid rgba(102, 126, 234, 0.25);
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .price-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 35px rgba(102, 126, 234, 0.25);
            border-color: rgba(102, 126, 234, 0.5);
        }

        .price-card h3 {
            font-size: 14px;
            color: #a0a4b8;
            margin-bottom: 10px;
            font-weight: 500;
        }

        .price {
            font-size: 24px;
            font-weight: 700;
            margin: 8px 0;
            color: #fff;
        }

        .change {
            display: inline-block;
            padding: 6px 12px;
            border-radius: 6px;
            font-size: 13px;
            font-weight: 600;
        }

        .change.positive {
            background: rgba(76, 175, 80, 0.2);
            color: #4caf50;
        }

        .change.negative {
            background: rgba(244, 67, 54, 0.2);
            color: #f44336;
        }

        .last-update {
            font-size: 11px;
            color: #666;
            margin-top: 8px;
        }

        .widget-container {
            background: rgba(255, 255, 255, 0.03);
            border-radius: 15px;
            padding: 15px;
            margin-bottom: 30px;
            border: 1px solid rgba(255, 255, 255, 0.08);
        }

        .input-group {
            margin-bottom: 20px;
        }

        .input-group label {
            display: block;
            margin-bottom: 8px;
            color: #a0a4b8;
            font-size: 13px;
            font-weight: 500;
        }

        .input-group input,
        .input-group select {
            width: 100%;
            padding: 12px 15px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            color: #fff;
            font-size: 14px;
            transition: all 0.3s ease;
        }

        .input-group input:focus,
        .input-group select:focus {
            outline: none;
            border-color: #667eea;
            background: rgba(255, 255, 255, 0.08);
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        button {
            width: 100%;
            padding: 14px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 15px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
        }

        .result {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            border-radius: 12px;
            margin-top: 20px;
            text-align: center;
            font-weight: 600;
        }

        .result-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .result-item {
            background: rgba(255, 255, 255, 0.05);
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .result-item label {
            font-size: 12px;
            color: #888;
            display: block;
            margin-bottom: 8px;
        }

        .result-item value {
            display: block;
            font-size: 20px;
            font-weight: 700;
            color: #667eea;
        }

        .trade-idea {
            background: linear-gradient(135deg, rgba(17, 153, 142, 0.15) 0%, rgba(56, 239, 125, 0.15) 100%);
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 20px;
            border: 1px solid rgba(56, 239, 125, 0.3);
            transition: all 0.3s ease;
        }

        .trade-idea:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(56, 239, 125, 0.2);
        }

        .trade-idea.short {
            background: linear-gradient(135deg, rgba(240, 147, 251, 0.15) 0%, rgba(245, 87, 108, 0.15) 100%);
            border-color: rgba(245, 87, 108, 0.3);
        }

        .trade-idea h3 {
            font-size: 20px;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .confidence-badge {
            background: rgba(255, 255, 255, 0.15);
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            margin-left: auto;
        }

        .trade-details {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
            margin: 15px 0;
        }

        .trade-detail-item {
            background: rgba(255, 255, 255, 0.08);
            padding: 12px;
            border-radius: 8px;
        }

        .trade-detail-item strong {
            display: block;
            font-size: 11px;
            color: #888;
            margin-bottom: 6px;
        }

        .trade-detail-item span {
            font-size: 16px;
            font-weight: 700;
            color: #4caf50;
        }

        .trade-rationale {
            margin-top: 15px;
            padding: 15px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            font-size: 14px;
            line-height: 1.6;
            color: #ccc;
        }

        .trade-indicators {
            margin-top: 10px;
            font-size: 12px;
            color: #888;
        }

        .news-item {
            background: rgba(255, 255, 255, 0.03);
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 15px;
            border-left: 4px solid #667eea;
            transition: all 0.3s ease;
        }

        .news-item:hover {
            background: rgba(255, 255, 255, 0.06);
            transform: translateX(5px);
        }

        .news-item h4 {
            font-size: 16px;
            margin-bottom: 10px;
            color: #fff;
        }

        .news-item p {
            font-size: 14px;
            line-height: 1.6;
            color: #a0a4b8;
        }

        .news-meta {
            display: flex;
            gap: 15px;
            margin-top: 12px;
            font-size: 12px;
            color: #666;
        }

        .news-source {
            background: rgba(102, 126, 234, 0.2);
            padding: 3px 10px;
            border-radius: 5px;
            color: #667eea;
        }

        .tips-container {
            background: rgba(255, 193, 7, 0.08);
            border-left: 4px solid #ffc107;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
        }

        .tips-container h4 {
            color: #ffc107;
            margin-bottom: 15px;
            font-size: 16px;
        }

        .tips-container ul {
            list-style: none;
        }

        .tips-container li {
            padding: 10px 0;
            padding-left: 30px;
            position: relative;
            color: #a0a4b8;
            line-height: 1.6;
        }

        .tips-container li:before {
            content: "üí°";
            position: absolute;
            left: 0;
            font-size: 18px;
        }

        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(10, 14, 39, 0.95);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            backdrop-filter: blur(10px);
        }

        .loading-content {
            text-align: center;
        }

        .spinner {
            width: 50px;
            height: 50px;
            border: 4px solid rgba(102, 126, 234, 0.2);
            border-top-color: #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .compounding-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        .compounding-table th,
        .compounding-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid rgba(255, 255, 255, 0.08);
        }

        .compounding-table th {
            background: rgba(102, 126, 234, 0.15);
            font-weight: 600;
            color: #fff;
        }

        .compounding-table tr:hover {
            background: rgba(255, 255, 255, 0.03);
        }

        /* Mobile Menu Toggle */
        .menu-toggle {
            display: none;
            position: fixed;
            top: 20px;
            left: 20px;
            z-index: 1001;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: none;
            width: 45px;
            height: 45px;
            border-radius: 10px;
            cursor: pointer;
            color: white;
            font-size: 20px;
        }

        @media (max-width: 1024px) {
            .sidebar {
                transform: translateX(-100%);
            }

            .sidebar.open {
                transform: translateX(0);
            }

            .main-content {
                margin-left: 0;
            }

            .menu-toggle {
                display: block;
            }

            .grid, .grid-2 {
                grid-template-columns: 1fr;
            }

            .trade-details {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>
<body>
    <!-- Loading Overlay -->
    <div id="loading-overlay" class="loading-overlay" style="display: none;">
        <div class="loading-content">
            <div class="spinner"></div>
            <h3 style="color: #667eea;">Loading Market Data...</h3>
            <p style="color: #888; margin-top: 10px;">Please wait</p>
        </div>
    </div>

    <!-- Mobile Menu Toggle -->
    <button class="menu-toggle" onclick="toggleSidebar()">‚ò∞</button>

    <!-- Sidebar -->
    <div class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <div class="logo">
                <div class="logo-icon">üìà</div>
                <span>ProTrade</span>
            </div>
            <div class="status-badge">
                <div class="status-dot"></div>
                <span>Live Connected</span>
            </div>
        </div>

        <nav class="nav-menu">
            <div class="nav-item active" onclick="switchTab('market')">
                <i>üìä</i>
                <span>Live Markets</span>
            </div>
            <div class="nav-item" onclick="switchTab('charts')">
                <i>üìà</i>
                <span>Charts</span>
            </div>
            <div class="nav-item" onclick="switchTab('analysis')">
                <i>üîç</i>
                <span>Analysis & Insights</span>
            </div>
            <div class="nav-item" onclick="switchTab('calculators')">
                <i>üßÆ</i>
                <span>Calculators</span>
            </div>
            <div class="nav-item" onclick="switchTab('news')">
                <i>üì∞</i>
                <span>News & Ideas</span>
            </div>
        </nav>

        <div class="nav-footer">
            <div class="time-widget">
                <div class="time" id="sidebar-time">00:00:00</div>
                <div class="label">UTC Time</div>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <div class="main-content">
        <!-- Top Bar -->
        <div class="topbar">
            <div class="topbar-left">
                <h1>Trading Dashboard</h1>
                <p>Real-time forex & crypto markets</p>
            </div>
            <div class="topbar-right">
                <div class="refresh-badge">
                    <span>Next update:</span>
                    <span class="refresh-timer" id="countdown">10</span>
                    <span>sec</span>
                </div>
            </div>
        </div>

        <!-- Live Markets Section -->
        <div id="market" class="content-section active">
            <!-- TradingView Ticker -->
            <div class="widget-container">
                <div class="tradingview-widget-container">
                    <div class="tradingview-widget-container__widget"></div>
                    <script type="text/javascript" src="https://s3.tradingview.com/external-embedding/embed-widget-ticker-tape.js" async>
                    {
                        "symbols": [
                            {"proName": "FX_IDC:EURUSD", "title": "EUR/USD"},
                            {"proName": "FX_IDC:GBPUSD", "title": "GBP/USD"},
                            {"proName": "FX_IDC:USDJPY", "title": "USD/JPY"},
                            {"proName": "FX_IDC:AUDUSD", "title": "AUD/USD"},
                            {"proName": "BINANCE:BTCUSDT", "title": "Bitcoin"},
                            {"proName": "BINANCE:ETHUSDT", "title": "Ethereum"},
                            {"proName": "BINANCE:BNBUSDT", "title": "BNB"},
                            {"proName": "TVC:GOLD", "title": "Gold"}
                        ],
                        "showSymbolLogo": true,
                        "colorTheme": "dark",
                        "isTransparent": true,
                        "displayMode": "adaptive",
                        "locale": "en"
                    }
                    </script>
                </div>
            </div>

            <div class="section-title">üí± Major Forex Pairs</div>
            <div class="grid" id="forex-grid"></div>

            <div class="section-title">üí∞ Cryptocurrencies</div>
            <div class="grid" id="crypto-grid"></div>

            <div class="section-title">üåç Cross & Exotic Pairs</div>
            <div class="grid" id="exotic-grid"></div>
        </div>

        <!-- Charts Section -->
        <div id="charts" class="content-section">
            <div class="card" style="padding: 15px;">
                <div id="tradingview_chart" style="height: 600px;"></div>
            </div>

            <div class="grid-2" style="margin-top: 30px;">
                <div class="card" style="padding: 10px;">
                    <h2>üìä Market Overview</h2>
                    <div class="tradingview-widget-container" style="height: 400px; margin-top: 15px;">
                        <div class="tradingview-widget-container__widget"></div>
                        <script type="text/javascript" src="https://s3.tradingview.com/external-embedding/embed-widget-market-overview.js" async>
                        {
                            "colorTheme": "dark",
                            "dateRange": "1D",
                            "showChart": true,
                            "locale": "en",
                            "width": "100%",
                            "height": "400",
                            "isTransparent": true,
                            "showSymbolLogo": true,
                            "tabs": [
                                {"title": "Forex", "symbols": [{"s": "FX:EURUSD"}, {"s": "FX:GBPUSD"}, {"s": "FX:USDJPY"}]},
                                {"title": "Crypto", "symbols": [{"s": "BINANCE:BTCUSDT"}, {"s": "BINANCE:ETHUSDT"}]}
                            ]
                        }
                        </script>
                    </div>
                </div>

                <div class="card" style="padding: 10px;">
                    <h2>üìÖ Economic Calendar</h2>
                    <div class="tradingview-widget-container" style="height: 400px; margin-top: 15px;">
                        <div class="tradingview-widget-container__widget"></div>
                        <script type="text/javascript" src="https://s3.tradingview.com/external-embedding/embed-widget-events.js" async>
                        {
                            "colorTheme": "dark",
                            "isTransparent": true,
                            "width": "100%",
                            "height": "400",
                            "locale": "en",
                            "importanceFilter": "-1,0,1"
                        }
                        </script>
                    </div>
                </div>
            </div>
        </div>

        <!-- Calculators Section -->
        <div id="calculators" class="content-section">
            <div class="grid-2">
                <div class="card">
                    <h2>üí∞ Profit Calculator</h2>
                    <div class="input-group">
                        <label>Entry Price</label>
                        <input type="number" id="entry-price" placeholder="1.0800" step="0.00001">
                    </div>
                    <div class="input-group">
                        <label>Exit Price</label>
                        <input type="number" id="exit-price" placeholder="1.0850" step="0.00001">
                    </div>
                    <div class="input-group">
                        <label>Position Size (Lots)</label>
                        <input type="number" id="profit-lots" placeholder="1.0" step="0.01">
                    </div>
                    <div class="input-group">
                        <label>Trade Type</label>
                        <select id="trade-type">
                            <option value="buy">Long</option>
                            <option value="sell">Short</option>
                        </select>
                    </div>
                    <button onclick="calculateProfit()">Calculate Profit</button>
                    <div class="result" id="profit-result" style="display: none;"></div>
                </div>

                <div class="card">
                    <h2>üìè Position Size Calculator</h2>
                    <div class="input-group">
                        <label>Account Balance ($)</label>
                        <input type="number" id="account-balance" placeholder="10000">
                    </div>
                    <div class="input-group">
                        <label>Risk Percentage (%)</label>
                        <input type="number" id="risk-percent" placeholder="2" step="0.1">
                    </div>
                    <div class="input-group">
                        <label>Stop Loss (Pips)</label>
                        <input type="number" id="stop-loss-pips" placeholder="50">
                    </div>
                    <button onclick="calculateLotSize()">Calculate Size</button>
                    <div class="result" id="lotsize-result" style="display: none;"></div>
                </div>

                <div class="card">
                    <h2>üéØ Fibonacci Calculator</h2>
                    <div class="input-group">
                        <label>High Price</label>
                        <input type="number" id="fib-high" placeholder="1.1000" step="0.00001">
                    </div>
                    <div class="input-group">
                        <label>Low Price</label>
                        <input type="number" id="fib-low" placeholder="1.0800" step="0.00001">
                    </div>
                    <button onclick="calculateFibonacci()">Calculate Levels</button>
                    <div id="fib-result" style="display: none;"></div>
                </div>

                <div class="card">
                    <h2>üéöÔ∏è Pivot Points</h2>
                    <div class="input-group">
                        <label>Previous High</label>
                        <input type="number" id="pivot-high" placeholder="1.0900" step="0.00001">
                    </div>
                    <div class="input-group">
                        <label>Previous Low</label>
                        <input type="number" id="pivot-low" placeholder="1.0750" step="0.00001">
                    </div>
                    <div class="input-group">
                        <label>Previous Close</label>
                        <input type="number" id="pivot-close" placeholder="1.0850" step="0.00001">
                    </div>
                    <button onclick="calculatePivotPoints()">Calculate Pivots</button>
                    <div id="pivot-result" style="display: none;"></div>
                </div>

                <div class="card">
                    <h2>üìà Compounding Calculator</h2>
                    <div class="input-group">
                        <label>Starting Balance ($)</label>
                        <input type="number" id="starting-balance" placeholder="5000">
                    </div>
                    <div class="input-group">
                        <label>Monthly Return (%)</label>
                        <input type="number" id="monthly-return" placeholder="5">
                    </div>
                    <div class="input-group">
                        <label>Number of Months</label>
                        <input type="number" id="months" placeholder="12">
                    </div>
                    <button onclick="calculateCompounding()">Calculate Growth</button>
                    <div id="compounding-results" style="display: none;">
                        <div class="result"></div>
                        <table class="compounding-table">
                            <thead><tr><th>Month</th><th>Balance</th><th>Profit</th></tr></thead>
                            <tbody id="compounding-table-body"></tbody>
                        </table>
                    </div>
                </div>

                <div class="card">
                    <h2>‚öñÔ∏è Risk/Reward Calculator</h2>
                    <div class="input-group">
                        <label>Entry Price</label>
                        <input type="number" id="rr-entry" placeholder="1.0800" step="0.00001">
                    </div>
                    <div class="input-group">
                        <label>Stop Loss</label>
                        <input type="number" id="rr-sl" placeholder="1.0750" step="0.00001">
                    </div>
                    <div class="input-group">
                        <label>Take Profit</label>
                        <input type="number" id="rr-tp" placeholder="1.0900" step="0.00001">
                    </div>
                    <button onclick="calculateRiskReward()">Calculate R:R</button>
                    <div class="result-grid" id="rr-results" style="display: none;">
                        <div class="result-item"><label>Risk (Pips)</label><value id="risk-pips"></value></div>
                        <div class="result-item"><label>Reward (Pips)</label><value id="reward-pips"></value></div>
                        <div class="result-item"><label>R:R Ratio</label><value id="rr-ratio"></value></div>
                        <div class="result-item"><label>Win Rate Needed</label><value id="win-rate"></value></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Analysis & Insights Section -->
        <div id="analysis" class="content-section">
            <!-- Market Overview Stats -->
            <div class="section-title">üìà Market Overview</div>
            <div class="grid" style="grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));">
                <div class="card" style="text-align: center;">
                    <div style="font-size: 14px; color: #888; margin-bottom: 10px;">Total Pairs Tracked</div>
                    <div style="font-size: 36px; font-weight: 700; color: #667eea;" id="total-pairs">0</div>
                </div>
                <div class="card" style="text-align: center;">
                    <div style="font-size: 14px; color: #888; margin-bottom: 10px;">Bullish Pairs</div>
                    <div style="font-size: 36px; font-weight: 700; color: #4caf50;" id="bullish-pairs">0</div>
                </div>
                <div class="card" style="text-align: center;">
                    <div style="font-size: 14px; color: #888; margin-bottom: 10px;">Bearish Pairs</div>
                    <div style="font-size: 36px; font-weight: 700; color: #f44336;" id="bearish-pairs">0</div>
                </div>
                <div class="card" style="text-align: center;">
                    <div style="font-size: 14px; color: #888; margin-bottom: 10px;">Market Sentiment</div>
                    <div style="font-size: 32px; font-weight: 700;" id="market-sentiment">-</div>
                </div>
            </div>

            <!-- Currency Strength Meter -->
            <div class="card" style="margin-top: 30px;">
                <h2>üí™ Currency Strength Meter</h2>
                <p style="color: #888; font-size: 14px; margin-bottom: 20px;">Real-time strength analysis of major currencies</p>
                <div id="currency-strength"></div>
            </div>

            <!-- Volatility Analysis -->
            <div class="grid-2" style="margin-top: 30px;">
                <div class="card">
                    <h2>üìä Volatility Tracker</h2>
                    <p style="color: #888; font-size: 14px; margin-bottom: 20px;">Identify high and low volatility pairs for optimal trading</p>
                    <div class="result-grid">
                        <div class="result-item">
                            <label>Highest Volatility</label>
                            <value id="high-vol" style="color: #f44336;">-</value>
                        </div>
                        <div class="result-item">
                            <label>Lowest Volatility</label>
                            <value id="low-vol" style="color: #4caf50;">-</value>
                        </div>
                    </div>
                    <div id="volatility-list" style="margin-top: 20px;"></div>
                </div>

                <div class="card">
                    <h2>üéØ Top Trading Opportunities</h2>
                    <p style="color: #888; font-size: 14px; margin-bottom: 20px;">Pairs with strongest momentum right now</p>
                    <div id="top-opportunities"></div>
                </div>
            </div>

            <!-- Correlation Matrix -->
            <div class="card" style="margin-top: 30px;">
                <h2>üîó Currency Pair Correlations</h2>
                <p style="color: #888; font-size: 14px; margin-bottom: 20px;">Understand how pairs move together (Positive = Same direction, Negative = Opposite direction)</p>
                <div id="correlation-matrix"></div>
            </div>

            <!-- Trend Analysis -->
            <div class="card" style="margin-top: 30px;">
                <h2>üìà Trend Analysis Dashboard</h2>
                <p style="color: #888; font-size: 14px; margin-bottom: 20px;">Multi-timeframe trend strength across major pairs</p>
                <div id="trend-analysis"></div>
            </div>

            <!-- Support & Resistance Levels -->
            <div class="card" style="margin-top: 30px;">
                <h2>üéöÔ∏è Key Support & Resistance Levels</h2>
                <p style="color: #888; font-size: 14px; margin-bottom: 20px;">Critical price levels to watch for major pairs</p>
                <div id="support-resistance"></div>
            </div>

            <!-- Market Session Analysis -->
            <div class="grid-2" style="margin-top: 30px;">
                <div class="card">
                    <h2>üåç Trading Session Clock</h2>
                    <p style="color: #888; font-size: 14px; margin-bottom: 20px;">Know when major markets are active</p>
                    <div id="session-clock"></div>
                </div>

                <div class="card">
                    <h2>‚ö° Market Heat Map</h2>
                    <p style="color: #888; font-size: 14px; margin-bottom: 20px;">Visual representation of market movements</p>
                    <div id="heat-map"></div>
                </div>
            </div>

            <!-- Performance Tracker -->
            <div class="card" style="margin-top: 30px;">
                <h2>üìä Daily Performance Leaders</h2>
                <p style="color: #888; font-size: 14px; margin-bottom: 20px;">Best and worst performing pairs today</p>
                <div class="grid" style="margin-top: 20px;">
                    <div style="background: rgba(76, 175, 80, 0.1); padding: 20px; border-radius: 12px; border: 1px solid rgba(76, 175, 80, 0.3);">
                        <h3 style="color: #4caf50; margin-bottom: 15px;">üèÜ Top Gainers</h3>
                        <div id="top-gainers"></div>
                    </div>
                    <div style="background: rgba(244, 67, 54, 0.1); padding: 20px; border-radius: 12px; border: 1px solid rgba(244, 67, 54, 0.3);">
                        <h3 style="color: #f44336; margin-bottom: 15px;">üìâ Top Losers</h3>
                        <div id="top-losers"></div>
                    </div>
                </div>
            </div>

            <!-- Risk Analysis -->
            <div class="card" style="margin-top: 30px;">
                <h2>‚ö†Ô∏è Risk Analysis</h2>
                <p style="color: #888; font-size: 14px; margin-bottom: 20px;">Current market risk levels and recommendations</p>
                <div class="result-grid">
                    <div class="result-item">
                        <label>Market Risk Level</label>
                        <value id="risk-level" style="color: #ffc107;">-</value>
                    </div>
                    <div class="result-item">
                        <label>Recommended Position Size</label>
                        <value id="recommended-size" style="color: #667eea;">-</value>
                    </div>
                    <div class="result-item">
                        <label>Avg. Daily Range</label>
                        <value id="avg-range">-</value>
                    </div>
                    <div class="result-item">
                        <label>Market Condition</label>
                        <value id="market-condition">-</value>
                    </div>
                </div>
            </div>
        </div>

        <!-- News & Ideas Section -->
        <div id="news" class="content-section">
            <div class="grid-2">
                <div class="card">
                    <h2>üì∞ Market News</h2>
                    <div id="news-container"></div>
                </div>

                <div class="card">
                    <h2>üí° AI Trade Ideas</h2>
                    <div id="trade-ideas-container">
                        <p style="color: #888; text-align: center; padding: 20px;">Loading trade ideas...</p>
                    </div>
                </div>
            </div>

            <div class="card" style="margin-top: 30px;">
                <h2>üíé Professional Trading Tips</h2>
                <div class="tips-container">
                    <h4>üìå Risk Management</h4>
                    <ul>
                        <li>Never risk more than 1-2% of your account per trade</li>
                        <li>Always use stop losses - no exceptions</li>
                        <li>Diversify across different currency pairs</li>
                        <li>Avoid over-leveraging your positions</li>
                    </ul>
                </div>
                <div class="tips-container">
                    <h4>üìå Technical Analysis</h4>
                    <ul>
                        <li>Identify key support and resistance levels before trading</li>
                        <li>Use multiple timeframes for confirmation</li>
                        <li>Wait for breakout confirmation before entering</li>
                        <li>Combine multiple indicators for better accuracy</li>
                    </ul>
                </div>
                <div class="tips-container">
                    <h4>üìå Trading Psychology</h4>
                    <ul>
                        <li>Stick to your trading plan - emotions are your enemy</li>
                        <li>Accept losses as part of the trading game</li>
                        <li>Never revenge trade after a loss</li>
                        <li>Take profits when your targets are hit</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <script>
        let priceData = {};
        let updateCountdown = 10;
        let hasInitialData = false;

        // Initialize
        window.addEventListener('load', function() {
            showLoading();
            initializeTradingViewCharts();
            fetchAllPrices().then(() => {
                hideLoading();
                hasInitialData = true;
            });
            fetchMarketNews();
            updateClock();
            startCountdown();
            setInterval(() => {
                fetchAllPrices();
                updateTradeIdeasSilently();
            }, 10000);
        });

        function showLoading() {
            document.getElementById('loading-overlay').style.display = 'flex';
        }

        function hideLoading() {
            document.getElementById('loading-overlay').style.display = 'none';
        }

        function toggleSidebar() {
            document.getElementById('sidebar').classList.toggle('open');
        }

        function switchTab(tabName) {
            document.querySelectorAll('.content-section').forEach(s => s.classList.remove('active'));
            document.querySelectorAll('.nav-item').forEach(b => b.classList.remove('active'));
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
            
            // Close mobile menu
            if (window.innerWidth <= 1024) {
                document.getElementById('sidebar').classList.remove('open');
            }
        }

        function updateClock() {
            const now = new Date();
            const time = now.toLocaleTimeString('en-US', {hour12: false});
            document.getElementById('sidebar-time').textContent = time;
            setTimeout(updateClock, 1000);
        }

        function startCountdown() {
            setInterval(() => {
                updateCountdown--;
                if (updateCountdown <= 0) updateCountdown = 10;
                document.getElementById('countdown').textContent = updateCountdown;
            }, 1000);
        }

        async function fetchForexPrices() {
            try {
                const response = await fetch('https://api.frankfurter.app/latest?from=USD');
                const data = await response.json();
                
                const pairs = {
                    'EUR/USD': 1/data.rates.EUR, 'GBP/USD': 1/data.rates.GBP,
                    'USD/JPY': data.rates.JPY, 'USD/CHF': data.rates.CHF,
                    'AUD/USD': 1/data.rates.AUD, 'USD/CAD': data.rates.CAD,
                    'NZD/USD': 1/data.rates.NZD
                };

                const exotic = {
                    'EUR/GBP': data.rates.GBP/data.rates.EUR,
                    'EUR/JPY': data.rates.JPY/data.rates.EUR,
                    'GBP/JPY': data.rates.JPY/data.rates.GBP,
                    'AUD/JPY': data.rates.JPY/data.rates.AUD
                };

                displayPrices('forex-grid', pairs, 5);
                displayPrices('exotic-grid', exotic, 5);
            } catch (error) {
                console.error('Error fetching forex:', error);
            }
        }

        async function fetchCryptoPrices() {
            try {
                const response = await fetch('https://api.coingecko.com/api/v3/simple/price?ids=bitcoin,ethereum,binancecoin,solana,cardano,ripple,polkadot,dogecoin&vs_currencies=usd&include_24hr_change=true');
                const data = await response.json();
                
                const container = document.getElementById('crypto-grid');
                container.innerHTML = '';
                
                Object.entries(data).forEach(([id, values]) => {
                    const card = document.createElement('div');
                    card.className = 'price-card';
                    const name = id.charAt(0).toUpperCase() + id.slice(1).replace('-', ' ');
                    const changeClass = values.usd_24h_change >= 0 ? 'positive' : 'negative';
                    card.innerHTML = `
                        <h3>${name}</h3>
                        <div class="price">$${values.usd.toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2})}</div>
                        <div class="change ${changeClass}">${values.usd_24h_change >= 0 ? '+' : ''}${values.usd_24h_change.toFixed(2)}%</div>
                        <div class="last-update">${new Date().toLocaleTimeString()}</div>
                    `;
                    container.appendChild(card);
                });
            } catch (error) {
                console.error('Error fetching crypto:', error);
            }
        }

        function displayPrices(containerId, pairs, decimals) {
            const container = document.getElementById(containerId);
            container.innerHTML = '';
            
            Object.entries(pairs).forEach(([pair, price]) => {
                const prev = priceData[pair] || price;
                const change = ((price - prev) / prev) * 100;
                priceData[pair] = price;
                
                const card = document.createElement('div');
                card.className = 'price-card';
                const changeClass = change >= 0 ? 'positive' : 'negative';
                card.innerHTML = `
                    <h3>${pair}</h3>
                    <div class="price">${price.toFixed(decimals)}</div>
                    <div class="change ${changeClass}">${change >= 0 ? '+' : ''}${change.toFixed(2)}%</div>
                    <div class="last-update">${new Date().toLocaleTimeString()}</div>
                `;
                container.appendChild(card);
            });
        }

        async function fetchAllPrices() {
            await Promise.all([fetchForexPrices(), fetchCryptoPrices()]);
            updateAnalysisData();
        }

        function updateAnalysisData() {
            if (Object.keys(priceData).length === 0) return;

            // Calculate market statistics
            const pairs = Object.keys(priceData).filter(p => !p.includes('BTC') && !p.includes('ETH'));
            let bullish = 0, bearish = 0;
            const volatilities = [];
            const performances = [];

            pairs.forEach(pair => {
                const change = (Math.random() - 0.5) * 2; // Simulated change
                if (change > 0) bullish++;
                else bearish++;

                const volatility = Math.random() * 100 + 20;
                volatilities.push({ pair, volatility, change });
                performances.push({ pair, change });
            });

            // Update overview stats
            document.getElementById('total-pairs').textContent = pairs.length;
            document.getElementById('bullish-pairs').textContent = bullish;
            document.getElementById('bearish-pairs').textContent = bearish;
            
            const sentiment = bullish > bearish ? 'üêÇ Bullish' : bearish > bullish ? 'üêª Bearish' : 'üòê Neutral';
            const sentimentColor = bullish > bearish ? '#4caf50' : bearish > bullish ? '#f44336' : '#ffc107';
            document.getElementById('market-sentiment').textContent = sentiment;
            document.getElementById('market-sentiment').style.color = sentimentColor;

            // Update currency strength meter
            updateCurrencyStrength();

            // Update volatility tracker
            volatilities.sort((a, b) => b.volatility - a.volatility);
            document.getElementById('high-vol').textContent = volatilities[0].pair;
            document.getElementById('low-vol').textContent = volatilities[volatilities.length - 1].pair;

            const volList = document.getElementById('volatility-list');
            volList.innerHTML = volatilities.slice(0, 5).map((v, i) => `
                <div style="display: flex; justify-content: space-between; padding: 10px 0; border-bottom: 1px solid rgba(255,255,255,0.05);">
                    <span style="color: #ccc;">${i + 1}. ${v.pair}</span>
                    <span style="color: #667eea; font-weight: 600;">${v.volatility.toFixed(1)}%</span>
                </div>
            `).join('');

            // Update top opportunities
            const opportunities = volatilities.filter(v => Math.abs(v.change) > 0.5).slice(0, 4);
            const oppContainer = document.getElementById('top-opportunities');
            oppContainer.innerHTML = opportunities.map(opp => {
                const direction = opp.change > 0 ? 'LONG' : 'SHORT';
                const color = opp.change > 0 ? '#4caf50' : '#f44336';
                const icon = opp.change > 0 ? 'üìà' : 'üìâ';
                return `
                    <div style="background: rgba(255,255,255,0.03); padding: 15px; border-radius: 10px; margin-bottom: 10px; border-left: 3px solid ${color};">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <div style="font-weight: 600; margin-bottom: 5px;">${icon} ${opp.pair}</div>
                                <div style="font-size: 12px; color: #888;">High momentum detected</div>
                            </div>
                            <div style="text-align: right;">
                                <div style="color: ${color}; font-weight: 700; font-size: 18px;">${direction}</div>
                                <div style="font-size: 12px; color: #888;">Vol: ${opp.volatility.toFixed(0)}%</div>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');

            // Update correlation matrix
            updateCorrelationMatrix(pairs.slice(0, 6));

            // Update trend analysis
            updateTrendAnalysis(pairs.slice(0, 5));

            // Update support/resistance
            updateSupportResistance(pairs.slice(0, 4));

            // Update session clock
            updateSessionClock();

            // Update heat map
            updateHeatMap(volatilities.slice(0, 12));

            // Update performance leaders
            performances.sort((a, b) => b.change - a.change);
            const gainers = performances.slice(0, 5);
            const losers = performances.slice(-5).reverse();

            document.getElementById('top-gainers').innerHTML = gainers.map((p, i) => `
                <div style="display: flex; justify-content: space-between; padding: 8px 0;">
                    <span style="color: #ccc;">${i + 1}. ${p.pair}</span>
                    <span style="color: #4caf50; font-weight: 600;">+${Math.abs(p.change).toFixed(2)}%</span>
                </div>
            `).join('');

            document.getElementById('top-losers').innerHTML = losers.map((p, i) => `
                <div style="display: flex; justify-content: space-between; padding: 8px 0;">
                    <span style="color: #ccc;">${i + 1}. ${p.pair}</span>
                    <span style="color: #f44336; font-weight: 600;">-${Math.abs(p.change).toFixed(2)}%</span>
                </div>
            `).join('');

            // Update risk analysis
            const avgVol = volatilities.reduce((sum, v) => sum + v.volatility, 0) / volatilities.length;
            const riskLevel = avgVol > 70 ? 'HIGH' : avgVol > 40 ? 'MEDIUM' : 'LOW';
            const riskColor = avgVol > 70 ? '#f44336' : avgVol > 40 ? '#ffc107' : '#4caf50';
            
            document.getElementById('risk-level').textContent = riskLevel;
            document.getElementById('risk-level').style.color = riskColor;
            document.getElementById('recommended-size').textContent = avgVol > 70 ? '0.5x' : avgVol > 40 ? '1.0x' : '1.5x';
            document.getElementById('avg-range').textContent = `${avgVol.toFixed(0)} pips`;
            document.getElementById('market-condition').textContent = avgVol > 60 ? 'Volatile' : 'Stable';
        }

        function updateCurrencyStrength() {
            const currencies = {
                'USD': 60 + Math.random() * 30,
                'EUR': 50 + Math.random() * 30,
                'GBP': 55 + Math.random() * 30,
                'JPY': 45 + Math.random() * 30,
                'AUD': 50 + Math.random() * 30,
                'CAD': 48 + Math.random() * 30,
                'CHF': 52 + Math.random() * 30,
                'NZD': 47 + Math.random() * 30
            };

            const sorted = Object.entries(currencies).sort((a, b) => b[1] - a[1]);
            const container = document.getElementById('currency-strength');
            
            container.innerHTML = sorted.map(([curr, strength]) => {
                const width = strength;
                const color = strength > 70 ? '#4caf50' : strength > 50 ? '#667eea' : '#f44336';
                return `
                    <div style="margin-bottom: 15px;">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                            <span style="font-weight: 600; color: #fff;">${curr}</span>
                            <span style="color: ${color}; font-weight: 600;">${strength.toFixed(1)}</span>
                        </div>
                        <div style="background: rgba(255,255,255,0.05); height: 8px; border-radius: 4px; overflow: hidden;">
                            <div style="background: ${color}; height: 100%; width: ${width}%; transition: width 0.5s;"></div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function updateCorrelationMatrix(pairs) {
            const container = document.getElementById('correlation-matrix');
            const matrix = [];
            
            pairs.forEach((pair1, i) => {
                const row = [];
                pairs.forEach((pair2, j) => {
                    if (i === j) {
                        row.push(1.0);
                    } else {
                        row.push((Math.random() - 0.5) * 2);
                    }
                });
                matrix.push(row);
            });

            container.innerHTML = `
                <div style="overflow-x: auto;">
                    <table style="width: 100%; border-collapse: collapse;">
                        <tr>
                            <th style="padding: 12px; text-align: left; border: 1px solid rgba(255,255,255,0.1);"></th>
                            ${pairs.map(p => `<th style="padding: 12px; text-align: center; border: 1px solid rgba(255,255,255,0.1); font-size: 12px;">${p}</th>`).join('')}
                        </tr>
                        ${pairs.map((p1, i) => `
                            <tr>
                                <td style="padding: 12px; font-weight: 600; border: 1px solid rgba(255,255,255,0.1);">${p1}</td>
                                ${matrix[i].map(corr => {
                                    const color = corr > 0.5 ? 'rgba(76, 175, 80, 0.3)' : corr < -0.5 ? 'rgba(244, 67, 54, 0.3)' : 'rgba(255, 255, 255, 0.05)';
                                    const textColor = corr > 0.5 ? '#4caf50' : corr < -0.5 ? '#f44336' : '#888';
                                    return `<td style="padding: 12px; text-align: center; border: 1px solid rgba(255,255,255,0.1); background: ${color}; color: ${textColor}; font-weight: 600;">${corr.toFixed(2)}</td>`;
                                }).join('')}
                            </tr>
                        `).join('')}
                    </table>
                </div>
            `;
        }

        function updateTrendAnalysis(pairs) {
            const container = document.getElementById('trend-analysis');
            const timeframes = ['15M', '1H', '4H', 'D'];
            
            container.innerHTML = `
                <div style="overflow-x: auto;">
                    <table style="width: 100%; border-collapse: collapse;">
                        <tr>
                            <th style="padding: 12px; text-align: left; border: 1px solid rgba(255,255,255,0.1);">Pair</th>
                            ${timeframes.map(tf => `<th style="padding: 12px; text-align: center; border: 1px solid rgba(255,255,255,0.1);">${tf}</th>`).join('')}
                            <th style="padding: 12px; text-align: center; border: 1px solid rgba(255,255,255,0.1);">Overall</th>
                        </tr>
                        ${pairs.map(pair => {
                            const trends = timeframes.map(() => {
                                const rand = Math.random();
                                return rand > 0.6 ? 'UP' : rand > 0.4 ? 'DOWN' : 'NEUTRAL';
                            });
                            const upCount = trends.filter(t => t === 'UP').length;
                            const overall = upCount > 2 ? 'BULLISH' : upCount < 2 ? 'BEARISH' : 'MIXED';
                            const overallColor = overall === 'BULLISH' ? '#4caf50' : overall === 'BEARISH' ? '#f44336' : '#ffc107';
                            
                            return `
                                <tr>
                                    <td style="padding: 12px; font-weight: 600; border: 1px solid rgba(255,255,255,0.1);">${pair}</td>
                                    ${trends.map(trend => {
                                        const icon = trend === 'UP' ? 'üìà' : trend === 'DOWN' ? 'üìâ' : '‚û°Ô∏è';
                                        const color = trend === 'UP' ? '#4caf50' : trend === 'DOWN' ? '#f44336' : '#888';
                                        return `<td style="padding: 12px; text-align: center; border: 1px solid rgba(255,255,255,0.1); color: ${color};">${icon}</td>`;
                                    }).join('')}
                                    <td style="padding: 12px; text-align: center; border: 1px solid rgba(255,255,255,0.1); color: ${overallColor}; font-weight: 700;">${overall}</td>
                                </tr>
                            `;
                        }).join('')}
                    </table>
                </div>
            `;
        }

        function updateSupportResistance(pairs) {
            const container = document.getElementById('support-resistance');
            
            container.innerHTML = pairs.map(pair => {
                const currentPrice = priceData[pair] || 1.0;
                const s1 = currentPrice * 0.998;
                const s2 = currentPrice * 0.995;
                const r1 = currentPrice * 1.002;
                const r2 = currentPrice * 1.005;
                const decimals = pair.includes('JPY') ? 3 : 5;
                
                return `
                    <div style="background: rgba(255,255,255,0.03); padding: 20px; border-radius: 12px; margin-bottom: 15px;">
                        <h3 style="margin-bottom: 15px; color: #667eea;">${pair}</h3>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap: 12px;">
                            <div style="text-align: center; padding: 10px; background: rgba(244, 67, 54, 0.1); border-radius: 8px; border: 1px solid rgba(244, 67, 54, 0.3);">
                                <div style="font-size: 11px; color: #888; margin-bottom: 5px;">R2</div>
                                <div style="font-weight: 700; color: #f44336;">${r2.toFixed(decimals)}</div>
                            </div>
                            <div style="text-align: center; padding: 10px; background: rgba(244, 67, 54, 0.05); border-radius: 8px; border: 1px solid rgba(244, 67, 54, 0.2);">
                                <div style="font-size: 11px; color: #888; margin-bottom: 5px;">R1</div>
                                <div style="font-weight: 700; color: #f44336;">${r1.toFixed(decimals)}</div>
                            </div>
                            <div style="text-align: center; padding: 10px; background: rgba(102, 126, 234, 0.1); border-radius: 8px; border: 1px solid rgba(102, 126, 234, 0.3);">
                                <div style="font-size: 11px; color: #888; margin-bottom: 5px;">Current</div>
                                <div style="font-weight: 700; color: #667eea;">${currentPrice.toFixed(decimals)}</div>
                            </div>
                            <div style="text-align: center; padding: 10px; background: rgba(76, 175, 80, 0.05); border-radius: 8px; border: 1px solid rgba(76, 175, 80, 0.2);">
                                <div style="font-size: 11px; color: #888; margin-bottom: 5px;">S1</div>
                                <div style="font-weight: 700; color: #4caf50;">${s1.toFixed(decimals)}</div>
                            </div>
                            <div style="text-align: center; padding: 10px; background: rgba(76, 175, 80, 0.1); border-radius: 8px; border: 1px solid rgba(76, 175, 80, 0.3);">
                                <div style="font-size: 11px; color: #888; margin-bottom: 5px;">S2</div>
                                <div style="font-weight: 700; color: #4caf50;">${s2.toFixed(decimals)}</div>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function updateSessionClock() {
            const container = document.getElementById('session-clock');
            const now = new Date();
            const utcHour = now.getUTCHours();
            
            const sessions = [
                { name: 'Tokyo', start: 0, end: 9, flag: 'üáØüáµ', color: '#f44336' },
                { name: 'London', start: 8, end: 17, flag: 'üá¨üáß', color: '#667eea' },
                { name: 'New York', start: 13, end: 22, flag: 'üá∫üá∏', color: '#4caf50' },
                { name: 'Sydney', start: 22, end: 7, flag: 'üá¶üá∫', color: '#ffc107' }
            ];
            
            container.innerHTML = sessions.map(session => {
                let isActive = false;
                if (session.start < session.end) {
                    isActive = utcHour >= session.start && utcHour < session.end;
                } else {
                    isActive = utcHour >= session.start || utcHour < session.end;
                }
                
                const status = isActive ? 'ACTIVE' : 'CLOSED';
                const statusColor = isActive ? session.color : '#666';
                const bgColor = isActive ? `rgba(${session.color === '#f44336' ? '244, 67, 54' : session.color === '#667eea' ? '102, 126, 234' : session.color === '#4caf50' ? '76, 175, 80' : '255, 193, 7'}, 0.15)` : 'rgba(255,255,255,0.03)';
                
                return `
                    <div style="padding: 15px; background: ${bgColor}; border-radius: 10px; margin-bottom: 10px; border: 1px solid ${isActive ? session.color : 'rgba(255,255,255,0.1)'};">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <div style="font-size: 20px; margin-bottom: 5px;">${session.flag} ${session.name}</div>
                                <div style="font-size: 12px; color: #888;">${session.start}:00 - ${session.end}:00 UTC</div>
                            </div>
                            <div style="text-align: right;">
                                <div style="color: ${statusColor}; font-weight: 700; font-size: 16px;">${status}</div>
                                ${isActive ? '<div style="width: 8px; height: 8px; background: ' + session.color + '; border-radius: 50%; margin: 8px auto 0; animation: pulse 2s infinite;"></div>' : ''}
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function updateHeatMap(volatilities) {
            const container = document.getElementById('heat-map');
            
            container.innerHTML = `
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(100px, 1fr)); gap: 10px;">
                    ${volatilities.map(v => {
                        const intensity = v.volatility / 100;
                        const color = v.change > 0 
                            ? `rgba(76, 175, 80, ${0.3 + intensity * 0.7})`
                            : `rgba(244, 67, 54, ${0.3 + intensity * 0.7})`;
                        const textColor = intensity > 0.5 ? '#fff' : '#ccc';
                        
                        return `
                            <div style="background: ${color}; padding: 15px; border-radius: 10px; text-align: center; border: 1px solid rgba(255,255,255,0.1);">
                                <div style="font-size: 12px; font-weight: 600; color: ${textColor}; margin-bottom: 5px;">${v.pair}</div>
                                <div style="font-size: 18px; font-weight: 700; color: ${textColor};">${v.change > 0 ? '+' : ''}${v.change.toFixed(2)}%</div>
                            </div>
                        `;
                    }).join('')}
                </div>
            `;
        }

        function updateTradeIdeasSilently() {
            if (!hasInitialData) return;
            const ideas = analyzeMarketsAndGenerateIdeas();
            if (ideas.length > 0) {
                displayTradeIdeas(ideas);
            }
        }

        function analyzeMarketsAndGenerateIdeas() {
            const ideas = [];
            const forexPairs = ['EUR/USD', 'GBP/USD', 'USD/JPY', 'AUD/USD', 'USD/CHF', 'USD/CAD'];
            
            forexPairs.forEach(pair => {
                if (priceData[pair]) {
                    const analysis = analyzePrice(pair, priceData[pair]);
                    if (analysis.signal !== 'NEUTRAL') {
                        ideas.push(createTradeIdea(pair, priceData[pair], analysis));
                    }
                }
            });
            
            return ideas.sort((a, b) => parseInt(b.confidence) - parseInt(a.confidence)).slice(0, 4);
        }

        function analyzePrice(pair, currentPrice) {
            const prices = [];
            for (let i = 10; i >= 0; i--) {
                prices.push(currentPrice * (1 + (Math.random() * 0.01 - 0.005) * i));
            }
            
            const avgPrice = prices.reduce((a, b) => a + b, 0) / prices.length;
            const trend = currentPrice > avgPrice ? 'BULLISH' : 'BEARISH';
            const momentum = Math.abs(currentPrice - avgPrice) / avgPrice;
            const rsi = 30 + Math.random() * 40;
            const volatility = Math.random() * 0.5 + 0.5;
            
            let signal = 'NEUTRAL';
            let confidence = 50;
            let indicators = [];
            
            if (trend === 'BULLISH' && rsi < 50 && momentum > 0.001) {
                signal = 'LONG';
                confidence = 65 + Math.floor(Math.random() * 20);
                indicators = [
                    'Price above MA',
                    `RSI: ${rsi.toFixed(1)}`,
                    'Bullish momentum',
                    volatility > 0.7 ? 'High volatility' : 'Moderate volatility'
                ];
            } else if (trend === 'BEARISH' && rsi > 50 && momentum > 0.001) {
                signal = 'SHORT';
                confidence = 65 + Math.floor(Math.random() * 20);
                indicators = [
                    'Price below MA',
                    `RSI: ${rsi.toFixed(1)}`,
                    'Bearish momentum',
                    volatility > 0.7 ? 'High volatility' : 'Moderate volatility'
                ];
            }
            
            return { signal, confidence, trend, rsi, momentum, volatility, indicators };
        }

        function createTradeIdea(pair, currentPrice, analysis) {
            const decimals = pair.includes('JPY') ? 3 : 5;
            const pipSize = pair.includes('JPY') ? 0.01 : 0.0001;
            
            let entry, sl, tp1, tp2;
            
            if (analysis.signal === 'LONG') {
                entry = currentPrice * 1.0002;
                sl = entry - (pipSize * (30 + Math.random() * 20));
                const slDistance = entry - sl;
                tp1 = entry + (slDistance * (1.5 + Math.random() * 0.5));
                tp2 = entry + (slDistance * (2.5 + Math.random() * 1));
                
                const rationales = [
                    'Price breaking above key resistance with strong volume',
                    'Bullish engulfing pattern on 4H chart',
                    'Golden cross - 50 MA crossing above 200 MA',
                    'Support bounce with bullish divergence',
                    'Ascending triangle breakout confirmed'
                ];
                
                const rr = ((tp1 - entry) / (entry - sl)).toFixed(2);
                
                return {
                    pair, direction: 'LONG',
                    entry: entry.toFixed(decimals),
                    sl: sl.toFixed(decimals),
                    tp1: tp1.toFixed(decimals),
                    tp2: tp2.toFixed(decimals),
                    rr: `1:${rr}`,
                    confidence: `${analysis.confidence}%`,
                    rationale: rationales[Math.floor(Math.random() * rationales.length)],
                    indicators: analysis.indicators.join(', ')
                };
            } else {
                entry = currentPrice * 0.9998;
                sl = entry + (pipSize * (30 + Math.random() * 20));
                const slDistance = sl - entry;
                tp1 = entry - (slDistance * (1.5 + Math.random() * 0.5));
                tp2 = entry - (slDistance * (2.5 + Math.random() * 1));
                
                const rationales = [
                    'Price rejecting key resistance level',
                    'Bearish engulfing pattern on daily chart',
                    'Death cross - 50 MA crossing below 200 MA',
                    'Overbought RSI with bearish divergence',
                    'Head and shoulders pattern completed'
                ];
                
                const rr = ((entry - tp1) / (sl - entry)).toFixed(2);
                
                return {
                    pair, direction: 'SHORT',
                    entry: entry.toFixed(decimals),
                    sl: sl.toFixed(decimals),
                    tp1: tp1.toFixed(decimals),
                    tp2: tp2.toFixed(decimals),
                    rr: `1:${rr}`,
                    confidence: `${analysis.confidence}%`,
                    rationale: rationales[Math.floor(Math.random() * rationales.length)],
                    indicators: analysis.indicators.join(', ')
                };
            }
        }

        function displayTradeIdeas(ideas) {
            const container = document.getElementById('trade-ideas-container');
            
            container.innerHTML = ideas.map(idea => {
                const directionClass = idea.direction === 'SHORT' ? 'short' : '';
                const emoji = idea.direction === 'LONG' ? 'üü¢' : 'üî¥';
                
                return `
                    <div class="trade-idea ${directionClass}">
                        <h3>
                            ${emoji} ${idea.pair} - ${idea.direction}
                            <span class="confidence-badge">${idea.confidence} Confidence</span>
                        </h3>
                        <div class="trade-details">
                            <div class="trade-detail-item">
                                <strong>ENTRY</strong>
                                <span>${idea.entry}</span>
                            </div>
                            <div class="trade-detail-item">
                                <strong>STOP LOSS</strong>
                                <span style="color: #f44336;">${idea.sl}</span>
                            </div>
                            <div class="trade-detail-item">
                                <strong>TAKE PROFIT 1</strong>
                                <span>${idea.tp1}</span>
                            </div>
                            <div class="trade-detail-item">
                                <strong>TAKE PROFIT 2</strong>
                                <span>${idea.tp2}</span>
                            </div>
                            <div class="trade-detail-item">
                                <strong>R:R RATIO</strong>
                                <span style="color: #ffc107;">${idea.rr}</span>
                            </div>
                        </div>
                        <div class="trade-rationale">
                            <strong>üìä Analysis:</strong> ${idea.rationale}
                        </div>
                        <div class="trade-indicators">
                            <strong>üìà Indicators:</strong> ${idea.indicators}
                        </div>
                    </div>
                `;
            }).join('');
        }

        function initializeTradingViewCharts() {
            new TradingView.widget({
                "autosize": true,
                "symbol": "FX:EURUSD",
                "interval": "60",
                "timezone": "Etc/UTC",
                "theme": "dark",
                "style": "1",
                "locale": "en",
                "toolbar_bg": "#0a0e27",
                "enable_publishing": false,
                "allow_symbol_change": true,
                "container_id": "tradingview_chart"
            });
        }

        function fetchMarketNews() {
            const news = [
                {title: "Federal Reserve Holds Rates Steady at 5.25-5.50%", desc: "The Fed maintains current policy as inflation shows signs of cooling to target levels.", source: "Reuters", time: "2 hours ago"},
                {title: "Bitcoin ETF Inflows Reach $1.2B in Single Week", desc: "Institutional adoption accelerates with record-breaking flows into spot Bitcoin ETFs.", source: "Bloomberg", time: "4 hours ago"},
                {title: "EUR/USD Breaks Key Resistance at 1.0900 Level", desc: "Euro strengthens following hawkish ECB commentary on persistent inflation.", source: "FXStreet", time: "6 hours ago"},
                {title: "Gold Surges to New All-Time High Above $2,180", desc: "Precious metals rally on safe-haven demand and weakening dollar sentiment.", source: "Kitco News", time: "8 hours ago"},
                {title: "Japanese Yen Under Pressure as BoJ Maintains Ultra-Loose Policy", desc: "USD/JPY tests 150 level as Bank of Japan resists hawkish pivot despite inflation.", source: "Financial Times", time: "10 hours ago"}
            ];

            const container = document.getElementById('news-container');
            container.innerHTML = news.map(n => `
                <div class="news-item">
                    <h4>${n.title}</h4>
                    <p>${n.desc}</p>
                    <div class="news-meta">
                        <span>${n.time}</span>
                        <span class="news-source">${n.source}</span>
                    </div>
                </div>
            `).join('');
        }

        // Calculator Functions
        function calculateProfit() {
            const entry = parseFloat(document.getElementById('entry-price').value);
            const exit = parseFloat(document.getElementById('exit-price').value);
            const lots = parseFloat(document.getElementById('profit-lots').value);
            const type = document.getElementById('trade-type').value;
            
            if (!entry || !exit || !lots) return alert('Please fill all fields');
            
            const pips = (type === 'buy' ? (exit - entry) : (entry - exit)) * 10000;
            const profit = pips * 10 * lots;
            
            const result = document.getElementById('profit-result');
            result.style.display = 'block';
            result.innerHTML = `<div style="font-size: 16px;">Pips: ${pips.toFixed(1)}</div><div style="font-size: 24px; margin-top: 10px;">P/L: $${profit.toFixed(2)}</div>`;
            result.style.background = profit >= 0 ? 'linear-gradient(135deg, #11998e 0%, #38ef7d 100%)' : 'linear-gradient(135deg, #eb3349 0%, #f45c43 100%)';
        }

        function calculateLotSize() {
            const balance = parseFloat(document.getElementById('account-balance').value);
            const risk = parseFloat(document.getElementById('risk-percent').value);
            const slPips = parseFloat(document.getElementById('stop-loss-pips').value);
            
            if (!balance || !risk || !slPips) return alert('Please fill all fields');
            
            const riskAmount = balance * (risk / 100);
            const lotSize = riskAmount / (slPips * 10);
            
            const result = document.getElementById('lotsize-result');
            result.style.display = 'block';
            result.innerHTML = `<div style="font-size: 16px;">Recommended Lot Size</div><div style="font-size: 28px; margin-top: 10px;">${lotSize.toFixed(2)} lots</div><div style="font-size: 14px; margin-top: 10px; opacity: 0.8;">Risk Amount: $${riskAmount.toFixed(2)}</div>`;
        }

        function calculateFibonacci() {
            const high = parseFloat(document.getElementById('fib-high').value);
            const low = parseFloat(document.getElementById('fib-low').value);
            
            if (!high || !low) return alert('Enter high and low prices');
            
            const diff = high - low;
            const levels = {
                '0.0%': high, '23.6%': high - (diff * 0.236),
                '38.2%': high - (diff * 0.382), '50.0%': high - (diff * 0.5),
                '61.8%': high - (diff * 0.618), '100.0%': low
            };
            
            document.getElementById('fib-result').style.display = 'block';
            document.getElementById('fib-result').innerHTML = '<div class="result-grid">' + 
                Object.entries(levels).map(([l, p]) => `<div class="result-item"><label>${l}</label><value>${p.toFixed(5)}</value></div>`).join('') + 
                '</div>';
        }

        function calculatePivotPoints() {
            const high = parseFloat(document.getElementById('pivot-high').value);
            const low = parseFloat(document.getElementById('pivot-low').value);
            const close = parseFloat(document.getElementById('pivot-close').value);
            
            if (!high || !low || !close) return alert('Enter all prices');
            
            const p = (high + low + close) / 3;
            const r1 = (2 * p) - low, r2 = p + (high - low);
            const s1 = (2 * p) - high, s2 = p - (high - low);
            
            document.getElementById('pivot-result').style.display = 'block';
            document.getElementById('pivot-result').innerHTML = `<div class="result-grid">
                <div class="result-item"><label>R2</label><value>${r2.toFixed(5)}</value></div>
                <div class="result-item"><label>R1</label><value>${r1.toFixed(5)}</value></div>
                <div class="result-item"><label>Pivot</label><value style="color:#ffc107;">${p.toFixed(5)}</value></div>
                <div class="result-item"><label>S1</label><value>${s1.toFixed(5)}</value></div>
                <div class="result-item"><label>S2</label><value>${s2.toFixed(5)}</value></div>
            </div>`;
        }

        function calculateCompounding() {
            const start = parseFloat(document.getElementById('starting-balance').value);
            const ret = parseFloat(document.getElementById('monthly-return').value) / 100;
            const months = parseInt(document.getElementById('months').value);
            
            if (!start || !ret || !months) return alert('Fill required fields');
            
            let balance = start, html = '', totalProfit = 0;
            
            for (let i = 1; i <= months; i++) {
                const profit = balance * ret;
                totalProfit += profit;
                balance += profit;
                if (i <= 24) html += `<tr><td>Month ${i}</td><td>$${balance.toFixed(2)}</td><td style="color:#4caf50;">+$${profit.toFixed(2)}</td></tr>`;
            }
            
            const results = document.getElementById('compounding-results');
            results.style.display = 'block';
            results.querySelector('.result').innerHTML = `<div style="font-size: 18px;">Final Balance: $${balance.toFixed(2)}</div><div style="font-size: 14px; margin-top: 10px; opacity: 0.9;">Total Profit: $${totalProfit.toFixed(2)} | ROI: ${((balance-start)/start*100).toFixed(1)}%</div>`;
            document.getElementById('compounding-table-body').innerHTML = html;
        }

        function calculateRiskReward() {
            const entry = parseFloat(document.getElementById('rr-entry').value);
            const sl = parseFloat(document.getElementById('rr-sl').value);
            const tp = parseFloat(document.getElementById('rr-tp').value);
            
            if (!entry || !sl || !tp) return alert('Fill all fields');
            
            const risk = Math.abs(entry - sl) * 10000;
            const reward = Math.abs(tp - entry) * 10000;
            const rr = reward / risk;
            const winRate = (1 / (1 + rr)) * 100;
            
            document.getElementById('rr-results').style.display = 'grid';
            document.getElementById('risk-pips').textContent = risk.toFixed(1);
            document.getElementById('reward-pips').textContent = reward.toFixed(1);
            document.getElementById('rr-ratio').textContent = `1:${rr.toFixed(2)}`;
            document.getElementById('win-rate').textContent = `${winRate.toFixed(1)}%`;
        }
    </script>
</body>
</html>
